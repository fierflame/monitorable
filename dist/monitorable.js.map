{"version":3,"file":"monitorable.js","sources":["../src/utils.ts","../src/state.ts","../src/executable.ts","../src/value.ts"],"sourcesContent":["\nlet printErrorLog: undefined | ((info: any) => void);\n/** 设置或移除错误打印函数 */\nexport function printError(fn?: (info: any) => void): void;\n/** 打印错误 */\nexport function printError(info: any, print: true): void;\n/** 打印错误 */\nexport function printError(info: any): void;\nexport function printError(info?: string | Error | ((info: any) => void), print = false) {\n\tif (!print && (typeof info === 'function' || info === undefined)) {\n\t\tprintErrorLog = info;\n\t\treturn;\n\t}\n\tif (typeof printErrorLog === 'function') {\n\t\tprintErrorLog(info);\n\t\treturn;\n\t}\n\tconsole.error(info);\n}\n\n/** 回调函数安全化处理 */\nexport function safeify<T extends any[]>(fn: (...p: T) => void): (...p: T) => void {\n\treturn (...p) => {\n\t\ttry {\n\t\t\tfn(...p);\n\t\t} catch(e) {\n\t\t\tprintError(e, true);\n\t\t}\n\t};\n}\n\nexport function getMepValue<K, V>(map: Map<K, V>, key: K, def: () => V): V {\n\tif (map.has(key)) {\n\t\treturn map.get(key)!;\n\t}\n\tconst value = def();\n\tmap.set(key, value);\n\treturn value;\n}\n","import { safeify, getMepValue } from './utils';\n\nconst ValueMap = new WeakMap<object | Function, object | Function>();\n\n/**\n * 判断对象是否可被代理\n */\nfunction isProxyable(v: any): v is object | Function {\n\treturn Boolean(v && ['object', 'function'].includes(typeof v));\n}\n\n/**\n * 获取被代理对象\n * @param value 要被代理的对象\n * @param nest 递归代理的层数\n */\nexport function getProxy<T>(value: T, nest: number | boolean = 0): T {\n\tif (!isProxyable(value)) { return value; }\n\tif (ValueMap.has(value)) { return value; }\n\tconst nestLayer: number = nest === true ? Infinity : nest || 0;\n\tconst proxy = new Proxy(value, {\n\t\tset(target, prop, value, receiver) {\n\t\t\tif (nest === false) { return Reflect.set(target, prop, value, receiver); }\n\t\t\tconst has = Reflect.has(target, prop);\n\t\t\tconst modified = Reflect.set(target, prop, value, getProxy(receiver));\n\t\t\tif (!modified) { return modified; }\n\t\t\tif (has !== Reflect.has(target, prop)) {\n\t\t\t\tmarkChange(target, true);\n\t\t\t}\n\t\t\treturn modified;\n\t\t},\n\t\tget(target, prop, receiver) {\n\t\t\tif (nest === false) { return Reflect.get(target, prop, receiver); }\n\t\t\tmarkRead(target, prop);\n\t\t\tconst value = Reflect.get(target, prop, getProxy(receiver));\n\t\t\tif (nestLayer > 0) {\n\t\t\t\treturn getProxy(value, nestLayer - 1);\n\t\t\t}\n\t\t\treturn value;\n\t\t},\n\t\tsetPrototypeOf(target, proto) {\n\t\t\tif (nest === false) { return Reflect.setPrototypeOf(target, proto); }\n\t\t\tconst oldProto = Reflect.getPrototypeOf(target);\n\t\t\tconst modified = Reflect.setPrototypeOf(target, proto);\n\t\t\tif (modified && oldProto !== proto) {\n\t\t\t\tmarkChange(target, false);\n\t\t\t}\n\t\t\treturn modified;\n\t\t},\n\t\tgetPrototypeOf(target) {\n\t\t\tif (nest === false) { return Reflect.getPrototypeOf(target); }\n\t\t\tmarkRead(target, false);\n\t\t\tconst value: any = Reflect.getPrototypeOf(target);\n\t\t\tif (nestLayer > 0) {\n\t\t\t\treturn getProxy(value, nestLayer - 1);\n\t\t\t}\n\t\t\treturn value;\n\t\t},\n\t\tdefineProperty(target, prop, attributes) {\n\t\t\tif (nest === false) { return Reflect.defineProperty(target, prop, attributes); }\n\t\t\tlet changed = true;\n\t\t\tif ('value' in attributes) {\n\t\t\t\tconst descriptor = Reflect.getOwnPropertyDescriptor(target, prop);\n\t\t\t\tif (descriptor && 'value' in descriptor && getValue(attributes.value) === getValue(descriptor.value)) {\n\t\t\t\t\tchanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst modified = Reflect.defineProperty(target, prop, attributes);\n\t\t\tif (changed && modified) {\n\t\t\t\tmarkChange(target, prop);\n\t\t\t}\n\t\t\treturn modified;\n\t\t},\n\t\tgetOwnPropertyDescriptor(target, prop) {\n\t\t\tif (nest === false) { return Reflect.getOwnPropertyDescriptor(target, prop); }\n\t\t\tmarkRead(target, prop);\n\t\t\treturn Reflect.getOwnPropertyDescriptor(target, prop);\n\t\t},\n\t\tdeleteProperty(target, prop) {\n\t\t\tif (nest === false) { return Reflect.deleteProperty(target, prop); }\n\t\t\tconst has = Reflect.has(target, prop);\n\t\t\tconst deleted = Reflect.deleteProperty(target, prop);\n\t\t\tif (has && !Reflect.has(target, prop)) {\n\t\t\t\tmarkChange(target, prop);\n\t\t\t\tmarkChange(target, true);\n\t\t\t}\n\t\t\treturn deleted;\n\t\t},\n\t\townKeys(target) {\n\t\t\tif (nest === false) { return Reflect.ownKeys(target); }\n\t\t\tmarkRead(target, true);\n\t\t\treturn Reflect.ownKeys(target);\n\t\t},\n\t\thas(target, prop) {\n\t\t\tif (nest === false) { return Reflect.has(target, prop); }\n\t\t\tmarkRead(target, true);\n\t\t\treturn Reflect.has(target, prop);\n\t\t},\n\t});\n\treturn proxy;\n}\n/** 获取被代理的原始值 */\nexport function getValue<T>(v: T): T {\n\treturn ValueMap.get(v as any) as T | undefined || v;\n}\nexport function equal(a: any, b: any): boolean {\n\treturn getValue(a) === getValue(b);\n}\n\nexport type ReadMap =  Map<object | Function, Set<string | boolean | symbol>>;\n\n/** 已被读取的 */\nlet read: ReadMap | undefined;\n\n/**\n * 标记已读状态\n * @param obj  要标记的对象\n * @param prop 要标记的属性\n */\nexport function markRead(obj: object | Function, prop: string | number | boolean | symbol) {\n\tif (!read) { return; }\n\tconst set = getMepValue(read, obj, () => new Set());\n\tif (typeof prop === 'number') {\n\t\tprop = String(prop);\n\t}\n\tset.add(prop);\n}\n/**\n * 监听函数的执行，并将执行过程中读取的对象值设置到 map 中\n * @param fn 要执行的含糊\n * @param map 用于存储被读取对象的 map\n * @param clear 是否在发送错误时清空 map\n */\nexport function observe<T>(fn: () => T, map: ReadMap = new Map(), clear = false): T {\n\tconst oldRead = read;\n\tread = map;\n\ttry {\n\t\treturn fn();\n\t} catch(e) {\n\t\tif (clear) {\n\t\t\tmap.clear();\n\t\t}\n\t\tthrow e;\n\t} finally {\n\t\tread = oldRead;\n\t}\n}\n\n\nconst watchList = new WeakMap<object | Function, Map<string | boolean | symbol, Set<() => void>>>();\n/**\n * 标记属性的修改，同时触发监听函数\n * @param target 要标记的对象\n * @param prop   要标记的属性 特别的，false 表示原型，true 表示成员\n */\nexport function markChange(target: object | Function, prop: string | number | boolean | symbol) {\n\tif (!target) { return; }\n\tif (!(typeof target === 'object' || typeof target === 'function')) { return; }\n\tif (typeof prop === 'number') {\n\t\tprop = String(prop);\n\t} else if (typeof prop !== 'symbol' && typeof prop !== 'string' && typeof prop !== 'boolean') {\n\t\treturn;\n\t}\n\n\tconst watch = watchList.get(target)?.get?.(prop);\n\tif (!watch) { return; }\n\tfor (const w of [...watch]) {\n\t\tw();\n\t}\n}\n\n/**\n * 监听对象属性的变化\n * @param target 要监听的对象\n * @param prop   要监听的属性名 特别的，false 表示原型，true 表示成员\n * @param fn     属性改变后触发的函数\n */\nexport function watchProp(target: object | Function, prop: string | number | boolean | symbol, cb: () => void): () => void {\n\tif (!target) { return () => {}; }\n\tif (!(typeof target === 'object' || typeof target === 'function')) { return () => {}; }\n\tif (typeof cb !== 'function') { return  () => {}; }\n\tif (typeof prop === 'number') { prop = String(prop); }\n\tif (typeof prop !== 'symbol' && typeof prop !== 'string' && typeof prop !== 'boolean') { return () => {}; }\n\tconst key = prop;\n\ttarget = getValue(target);\n\tlet map = watchList.get(target);\n\tif (!map) {\n\t\tmap = new Map();\n\t\twatchList.set(target, map);\n\t}\n\tconst list = getMepValue(map, key, () => new Set());\n\tcb = safeify(cb);\n\tlist.add(cb);\n\tlet removed = false;\n\treturn () => {\n\t\tif (removed) { return; }\n\t\tremoved = true;\n\n\t\t// 从当前列表中移除\n\t\tlist.delete(cb);\n\n\t\t// 从属性关联中删除\n\t\tif (list.size) { return; }\n\t\tif (!map) { return; }\n\t\tmap.delete(key);\n\n\t\t// 映射列表中删除\n\t\tif (map.size) { return; }\n\t\twatchList.delete(target);\n\t};\n\n}\n","import { observe, watchProp, ReadMap } from './state';\nimport { safeify } from './utils';\n\nexport interface Executable<T> {\n\t(): T;\n\tstop(): void;\n}\n/**\n * 创建可监听执行函数\n * @param fn 要监听执行的函数\n * @param cb 当监听的值发生可能改变时触发的回调函数，单如果没有被执行的函数或抛出错误，将会在每次 fn 被执行后直接执行\n */\nexport function createExecutable<T>(fn: () => T, cb: (changed: boolean) => void): Executable<T> {\n\tcb = safeify(cb);\n\tlet cancelList: (() => void)[] | undefined;\n\t/** 取消监听 */\n\tfunction cancel() {\n\t\tif (!cancelList) { return false; }\n\t\tconst list = cancelList;\n\t\tcancelList = undefined;\n\t\tlist.forEach(f => f());\n\t\treturn true;\n\t}\n\tfunction trigger() {\n\t\tif (!cancel()) { return; }\n\t\tcb(true);\n\t};\n\tfunction exec() {\n\t\tcancel();\n\t\tconst thisRead: ReadMap = new Map();\n\t\ttry {\n\t\t\treturn observe(fn, thisRead, true);\n\t\t} finally {\n\t\t\tif (thisRead.size) {\n\t\t\t\tcancelList = [];\n\t\t\t\tfor ( let [obj, props] of thisRead) {\n\t\t\t\t\tfor (const p of props) {\n\t\t\t\t\t\tcancelList.push(watchProp(obj, p, trigger));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcb(false);\n\t\t\t}\n\t\t}\n\t}\n\texec.stop = () => {\n\t\tif (!cancel()) { return; }\n\t\tcb(false);\n\t};\n\treturn exec;\n}\n","import { markRead, markChange, getValue, getProxy } from './state';\nimport { safeify } from './utils';\nimport { createExecutable } from './executable';\n\n/** 取消监听的方法 */\nexport interface CancelWatch {\n\t(): void;\n}\n/** 可监听值 */\nexport interface Value<T> {\n\t(): T;\n\t(v: T, mrak?: boolean): T;\n\tvalue: T;\n\twatch(cb: WatchCallback<T, this>): CancelWatch;\n\tstop(): void;\n}\n/** 监听函数 */\nexport interface WatchCallback<T, V extends Value<T> = Value<T>> {\n\t(v: V, stoped: boolean): void;\n}\nconst values = new WeakSet<Value<any>>();\nexport function isValue(x: any): x is Value<any> {\n\treturn values.has(x);\n}\n/** 触发监听 */\ninterface Trigger {\n\t(): void;\n\t/** 是否存在监听函数 */\n\thas(): boolean;\n\t/** 停止监听 */\n\tstop(): void;\n}\nexport interface Options {\n\tproxy?: boolean;\n}\n\n\nfunction createValue<T, V extends Value<T> = Value<T>>(\n\tgetValue: () => T,\n\tsetValue?: (value: T, markChange: () => void) => void,\n\tstop: () => void = () => {},\n\tchange: () => void = () => {},\n): {value: V, trigger: Trigger} {\n\tfunction set(v: T, marked = false) {\n\t\tif (!setValue) { return; }\n\t\ttry {\n\t\t\tsetValue(v, () => { marked = true; });\n\t\t} finally {\n\t\t\tif (marked) {\n\t\t\t\ttrigger();\n\t\t\t}\n\t\t}\n\t}\n\tfunction get() {\n\t\tmarkRead(value, 'value');\n\t\treturn getValue();\n\t}\n\tconst value: V = ((...v: [T] | [T, boolean] | []): T => {\n\t\tif (v.length) {\n\t\t\tset(v[0], v[1]);\n\t\t\treturn v[0];\n\t\t}\n\t\treturn get();\n\t}) as V;\n\tReflect.defineProperty(value, 'value', {\n\t\tget,\n\t\tset,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n\n\tfunction watch(cb: WatchCallback<T, V>): () => void {\n\t\tif (!callbacks) { return () => {}; }\n\t\tcb = safeify(cb);\n\t\tcallbacks.push(cb);\n\t\tchange();\n\t\tlet cancelled = false;\n\t\treturn () => {\n\t\t\tif (cancelled) { return; }\n\t\t\tcancelled = true;\n\t\t\tif (!callbacks) { return; }\n\t\t\tconst index = callbacks.findIndex(a => a === cb);\n\t\t\tif (index < 0) { return; }\n\t\t\tcallbacks.splice(index, 1);\n\t\t\tchange();\n\t\t};\n\t}\n\tlet callbacks: WatchCallback<T, V>[] | undefined = [];\n\tReflect.defineProperty(value, 'watch', {\n\t\tget() { return watch; },\n\t\tset() {},\n\t\tconfigurable: true,\n\t});\n\tconst trigger = (() => {\n\t\tif (!callbacks) { return; }\n\t\tmarkChange(value, 'value');\n\t\tfor (const cb of [...callbacks]) {\n\t\t\tcb(value, false);\n\t\t}\n\t}) as Trigger;\n\ttrigger.has = () => Boolean(callbacks?.length);\n\ttrigger.stop = () => {\n\t\tif (!callbacks) { return; }\n\t\tconst list = callbacks;\n\t\tcallbacks = undefined;\n\t\tfor (const cb of [...list]) {\n\t\t\tcb(value, true);\n\t\t}\n\t};\n\tvalues.add(value);\n\tlet stoped = false;\n\tvalue.stop = () => {\n\t\tif (stoped) { return; }\n\t\tstoped = true;\n\t\tstop();\n\t\ttrigger.stop();\n\n\t};\n\treturn {value, trigger};\n}\n/**\n * 创建引用值\n * @param value 初始值\n * @param options 选项\n */\nexport function value<T>(value: T, options?: Options | boolean): Value<T>;\nexport function value<T>(def: T, options?: Options | boolean): Value<T> {\n\tconst proxy = options === true || options && options.proxy;\n\tlet source: T;\n\tlet proxyed: T;\n\tconst { value } = createValue<T>(\n\t\t() => proxyed,\n\t\t(v, mark) => {\n\t\t\tif (proxy) { v = getValue(v); }\n\t\t\tif (v === source) { return; }\n\t\t\tsource = v;\n\t\t\tproxyed = proxy ? getProxy(source) : source;\n\t\t\tmark();\n\t\t},\n\t);\n\tvalue(def);\n\treturn value;\n}\n\n/**\n * 创建计算值\n * @param getter 取值方法\n * @param options 选项\n */\nexport function computed<T>(getter: () => T, options?: Options | boolean): Value<T>;\n/**\n * 创建可赋值计算值\n * @param getter 取值方法\n * @param setter 复制方法\n * @param options 选项\n */\nexport function computed<T>(getter: () => T, setter: (value: T) => void, options?: Options | boolean): Value<T>;\nexport function computed<T>(getter: () => T, setter?: ((value: T) => void) | Options | boolean, options?: Options | boolean): Value<T>;\nexport function computed<T>(getter: () => T, setter?: ((value: T) => void) | Options | boolean, options?: Options | boolean): Value<T> {\n\tif (typeof setter !== 'function') {\n\t\toptions = setter;\n\t\tsetter = undefined;\n\t}\n\tconst setValue = setter;\n\tconst proxy = options === true || options && options.proxy;\n\tlet source: T;\n\tlet proxyed: T;\n\tlet stoped = false;\n\tlet computed = false;\n\tlet trigger: Trigger | undefined;\n\tconst executable = createExecutable(getter, changed => {\n\t\tcomputed = !changed;\n\t\tif (changed  && trigger) {\n\t\t\ttrigger();\n\t\t}\n\t});\n\tfunction run() {\n\t\tcomputed = true;\n\t\ttry {\n\t\t\tsource = executable();\n\t\t\tif (proxy) { source = getValue(source); }\n\t\t\tproxyed = proxy ? getProxy(source) : source;\n\t\t\treturn proxyed;\n\t\t} catch(e) {\n\t\t\tif (!stoped) {\n\t\t\t\tcomputed = false;\n\t\t\t}\n\t\t\tthrow e;\n\t\t}\n\t}\n\tlet value: Value<T>;\n\t({value, trigger} = createValue<T, Value<T>>(\n\t\t() => computed || stoped ? proxyed : run(),\n\t\tsetValue && (v => setValue(proxy ? getValue(v) : v)),\n\t\t() => {\n\t\t\tif (stoped) { return; }\n\t\t\tstoped = true;\n\t\t\tif (computed) { return; }\n\t\t\trun();\n\t\t},\n\t));\n\treturn value;\n\n}\n\nexport function merge<T, V extends Value<T> = Value<T>>(cb: WatchCallback<T, V>): WatchCallback<T, V> {\n\tlet oldValue: any;\n\tlet runed = false;\n\treturn (v, stoped) => {\n\t\tif (stoped) { return cb(v, stoped); }\n\t\tconst newValue = getValue(v());\n\t\tif (newValue === oldValue && runed) { return; }\n\t\truned = true;\n\t\toldValue = newValue;\n\t\tcb(v, stoped);\n\t};\n}\n\ntype OffValue<V> = V extends Value<infer T> ? T : V;\n\nexport function mix<T extends object>(source: T): { [K in keyof T]: OffValue<T[K]>; } {\n\tfor (const k of Reflect.ownKeys(source)) {\n\t\tconst descriptor = Reflect.getOwnPropertyDescriptor(source, k);\n\t\tif (!descriptor) { continue; }\n\t\tif ('get' in descriptor || 'set' in descriptor || !('value' in descriptor)) { continue; }\n\t\tconst value = descriptor.value;\n\t\tif (!isValue(value)) { continue; }\n\t\tdescriptor.get = () => value.value;\n\t\tif (descriptor.writable) {\n\t\t\tdescriptor.set = v => (value as Value<any>).value = v;\n\t\t}\n\t\tdelete descriptor.value;\n\t\tdelete descriptor.writable;\n\t\tReflect.defineProperty(source, k, descriptor);\n\t}\n\treturn source as any;\n}\n"],"names":["printErrorLog","printError","info","print","undefined","console","error","safeify","fn","p","e","getMepValue","map","key","def","has","get","value","set","ValueMap","WeakMap","isProxyable","v","Boolean","includes","getProxy","nest","nestLayer","Infinity","proxy","Proxy","target","prop","receiver","Reflect","modified","markChange","markRead","setPrototypeOf","proto","oldProto","getPrototypeOf","defineProperty","attributes","changed","descriptor","getOwnPropertyDescriptor","getValue","deleteProperty","deleted","ownKeys","equal","a","b","read","obj","Set","String","add","observe","Map","clear","oldRead","watchList","watch","w","watchProp","cb","list","removed","delete","size","createExecutable","cancelList","cancel","forEach","f","trigger","exec","thisRead","props","push","stop","values","WeakSet","isValue","x","createValue","setValue","change","marked","length","enumerable","configurable","callbacks","cancelled","index","findIndex","splice","stoped","options","source","proxyed","mark","computed","getter","setter","executable","run","merge","oldValue","runed","newValue","mix","k","writable"],"mappings":"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"}