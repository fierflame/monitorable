{"version":3,"file":"monitorable.common.js","sources":["../src/utils.ts","../src/mark.ts","../src/exec.ts","../src/monitor.ts","../src/value.ts","../src/valueExt.ts","../src/merge.ts","../src/object.ts","../src/encase.ts"],"sourcesContent":["\nlet printErrorLog: undefined | ((info: any) => void);\n/** 打印错误 */\nexport function printError(info: any) {\n\tif (typeof printErrorLog === 'function') {\n\t\tprintErrorLog(info);\n\t\treturn;\n\t}\n\tconsole.error(info);\n}\n\nexport function setPrintError(p?: (info: any) => void) {\n\tprintErrorLog = typeof p === 'function' ? p : undefined;\n}\n\n/**\n * 判断对象是否可被代理\n */\nexport function encashable(v: any): v is object | Function {\n\treturn Boolean(v && ['object', 'function'].includes(typeof v));\n}\n\n\n/** 回调函数安全化处理 */\nexport function safeify<T extends any[]>(\n\tfn: (...p: T) => void\n): (...p: T) => void {\n\treturn (...p) => {\n\t\ttry {\n\t\t\tfn(...p);\n\t\t} catch(e) {\n\t\t\tprintError(e);\n\t\t}\n\t};\n}\n\n/** 回调函数安全化处理 */\nexport function safeCall(\n\tfn: () => void\n): void {\n\ttry {\n\t\tfn();\n\t} catch(e) {\n\t\tprintError(e);\n\t}\n}\nexport function getIndexes(\n\ttarget: any,\n\tprop: string | number | symbol | boolean,\n): [object | Function, string | boolean | symbol] | undefined {\n\tif (!target) { return undefined; }\n\tif (typeof target !== 'function' && typeof target !== 'object') {\n\t\treturn undefined;\n\t}\n\tif (typeof prop === 'number') { return [target, String(prop)]; }\n\tif (typeof prop === 'symbol') { return [target, prop]; }\n\tif (typeof prop === 'string') { return [target, prop]; }\n\tif (typeof prop === 'boolean') { return [target, prop]; }\n\treturn undefined;\n}\nexport function getMapValue<K, V>(\n\tmap: Map<K, V>,\n\tkey: K,\n\tdef: () => V,\n): V;\nexport function getMapValue<K extends object, V>(\n\tmap: WeakMap<K, V>,\n\tkey: K,\n\tdef: () => V,\n): V;\nexport function getMapValue<K, V>(\n\tmap: WeakMap<K & object, V> | Map<K, V>,\n\tkey: K,\n\tdef: () => V,\n): V {\n\tif (map.has(key as any)) {\n\t\treturn map.get(key as any)!;\n\t}\n\tconst value = def();\n\tmap.set(key as any, value);\n\treturn value;\n}\n","import { safeify, getMapValue, getIndexes } from './utils';\n\nexport type ReadMap = Map<\n\tobject | Function,\n\tMap<string | boolean | symbol, boolean>\n>;\n\n/** 已被读取的 */\nlet read: ReadMap | undefined;\n\n/**\n * 标记已读状态\n * @param obj  要标记的对象\n * @param prop 要标记的属性\n */\nexport function markRead(\n\ttarget: object | Function,\n\tprop: string | number | boolean | symbol,\n) {\n\tif (!read) { return; }\n\tconst indexes = getIndexes(target, prop);\n\tif (!indexes) { return; }\n\t[target, prop] = indexes;\n\tconst propMap = getMapValue(read, target, () => new Map());\n\tif (propMap.has(prop)) { return; }\n\tpropMap.set(prop, false);\n}\nexport interface ObserveOptions {\n\tpostpone?: boolean | 'priority';\n}\n/**\n * 监听函数的执行，并将执行过程中读取的对象值设置到 map 中\n * @param fn 要执行的含糊\n * @param map 用于存储被读取对象的 map\n */\nfunction observeRun<T>(\n\tmap: ReadMap,\n\tfn: () => T,\n\toptions?: ObserveOptions,\n): T {\n\tconst oldRead = read;\n\tread = map;\n\ttry {\n\t\tif (!options?.postpone) { return fn(); }\n\t\treturn postpone(fn, options.postpone === 'priority');\n\t} finally {\n\t\tread = oldRead;\n\t}\n}\nexport function observe<T>(\n\tmap: ReadMap,\n\tfn: () => T,\n\tpriority?: ObserveOptions,\n): T;\nexport function observe<T>(\n\tmap: ReadMap,\n\tpriority: ObserveOptions,\n\tf: () => T,\n): T;\nexport function observe<T>(\n\tmap: ReadMap,\n\tfn: (() => T) | ObserveOptions | undefined,\n\toptions?: (() => T) | ObserveOptions | undefined\n): T;\nexport function observe<T>(\n\tmap: ReadMap,\n\tfn: (() => T) | ObserveOptions | undefined,\n\toptions?: (() => T) | ObserveOptions | undefined\n): T {\n\n\tif (typeof fn === 'function') {\n\t\treturn observeRun(map, fn, options as ObserveOptions | undefined);\n\t}\n\tif (typeof options !== 'function') {\n\t\tthrow new Error('fn needs to be a function');\n\t}\n\treturn observeRun(map, options, fn);\n}\n\n\nconst watchList = new WeakMap<\n\tobject | Function,\n\tMap<string | boolean | symbol, Set<[() => void, boolean]>>\n>();\n\nfunction execWatch(\n\ttarget: object | Function,\n\tprop: string | boolean | symbol,\n\tfilter?: (isNonDeforred: boolean) => boolean,\n) {\n\tconst watch = watchList.get(target)?.get(prop);\n\tif (!watch) { return; }\n\tlet list = [...watch];\n\tif (filter) {\n\t\tlist = list.filter(([, t]) => filter(t));\n\t}\n\tlist.forEach(([w]) => w());\n}\n\ntype MarkMap = Map<\n\tobject | Function,\n\tSet<string | boolean | symbol>\n>;\nlet waitList: MarkMap | undefined;\n\nfunction runDeferred(list: MarkMap) {\n\tfor (const [target, set] of list.entries()) {\n\t\tconst propMap = read?.get(target);\n\t\tfor (const prop of set) {\n\t\t\texecWatch(target, prop, t => !t);\n\t\t\tif (propMap?.has(prop)) {\n\t\t\t\tpropMap.set(prop, true);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\nfunction postponeRun<T>(f: () => T, priority?: boolean): T {\n\tconst list = !priority && waitList || new Map();\n\tconst old = waitList;\n\twaitList = list;\n\ttry {\n\t\treturn f();\n\t} finally {\n\t\twaitList = old;\n\t\tif (list !== waitList) { runDeferred(list); }\n\t}\n}\nexport function postpone<T>(priority: boolean, f: () => T): T;\nexport function postpone<T>(fn: () => T, priority?: boolean): T;\nexport function postpone<T>(\n\tfn: (() => T) | boolean | undefined,\n\tpriority?: (() => T) | boolean | undefined\n): T;\nexport function postpone<T>(\n\tfn: (() => T) | boolean | undefined,\n\tpriority?: (() => T) | boolean | undefined\n): T {\n\tif (typeof fn === 'function') {\n\t\treturn postponeRun(fn, priority as boolean | undefined);\n\t}\n\tif (typeof priority !== 'function') {\n\t\tthrow new Error('fn needs to be a function');\n\t}\n\treturn postponeRun(priority, fn);\n}\n\n\nfunction wait(\n\ttarget: object | Function,\n\tprop: string | boolean | symbol,\n) {\n\tif (!waitList) { return false; }\n\tgetMapValue(waitList, target, () => new Set()).add(prop);\n\treturn true;\n}\n\n/**\n * 标记属性的修改，同时触发监听函数\n * @param target 要标记的对象\n * @param prop   要标记的属性 特别的，false 表示原型，true 表示成员\n */\nexport function markChange(\n\ttarget: object | Function,\n\tprop: string | number | boolean | symbol,\n) {\n\n\tconst indexes = getIndexes(target, prop);\n\tif (!indexes) { return; }\n\t[target, prop] = indexes;\n\tif (wait(target, prop)) {\n\t\texecWatch(target, prop, Boolean);\n\t\treturn;\n\t}\n\texecWatch(target, prop);\n}\n\n/**\n * 观察对象属性的变化\n * @param target 要观察的对象\n * @param prop   要观察的属性名 特别的，false 表示原型，true 表示成员\n * @param fn     属性改变后触发的函数\n */\nexport function watchProp(\n\ttarget: object | Function,\n\tprop: string | number | boolean | symbol,\n\tcb: () => void,\n\tdisdeferable: boolean = false,\n): () => void {\n\tif (typeof cb !== 'function') { return  () => {}; }\n\tconst indexes = getIndexes(target, prop);\n\tif (!indexes) { return () => {}; }\n\t[target, prop] = indexes;\n\n\tconst key = prop;\n\tlet map = watchList.get(target);\n\tif (!map) {\n\t\tmap = new Map();\n\t\twatchList.set(target, map);\n\t}\n\tconst list = getMapValue(map, key, () => new Set());\n\tconst item: [() => void, boolean] = [safeify(cb), disdeferable];\n\tlist.add(item);\n\tlet removed = false;\n\treturn () => {\n\t\tif (removed) { return; }\n\t\tremoved = true;\n\n\t\t// 从当前列表中移除\n\t\tlist.delete(item);\n\n\t\t// 从属性关联中删除\n\t\tif (list.size) { return; }\n\t\tif (!map) { return; }\n\t\tmap.delete(key);\n\n\t\t// 映射列表中删除\n\t\tif (map.size) { return; }\n\t\twatchList.delete(target);\n\t};\n\n}\n","import { safeify } from './utils';\nimport { observe, watchProp, ReadMap, ObserveOptions } from './mark';\n\nexport interface ExecResult<T> {\n\tresult: T;\n\tstop(): void;\n}\nexport interface ExecOptions extends ObserveOptions {\n\tresultOnly?: boolean;\n\tdisdeferable?: boolean;\n}\nfunction run<T>(\n\tcb: (changed: boolean) => void,\n\tfn: (stop: () => void) => T,\n\toptions?: ExecOptions,\n): ExecResult<T> | T {\n\tcb = safeify(cb);\n\tlet cancelList: (() => void)[] | undefined;\n\tconst postpone = options?.postpone;\n\tlet end = false;\n\t/** 取消监听 */\n\tfunction cancel() {\n\t\tif (end) { return false; }\n\t\tend = true;\n\t\tif (!cancelList) { return true; }\n\t\tconst list = cancelList;\n\t\tcancelList = undefined;\n\t\tlist.forEach(f => f());\n\t\treturn true;\n\t}\n\tfunction trigger() {\n\t\tif (!cancel()) { return; }\n\t\tcb(true);\n\t};\n\tfunction run(thisRead: ReadMap) {\n\t\tif (end) { return false; }\n\t\tif (!thisRead.size) {\n\t\t\tend = true;\n\t\t\treturn cb(false);\n\t\t}\n\t\tconst list: [\n\t\t\tobject | Function,\n\t\t\tstring | boolean | symbol,\n\t\t][] = [];\n\t\tfor ( let [obj, props] of thisRead) {\n\t\t\tfor (const [p, m] of props) {\n\t\t\t\tif (m) { return cb(true); }\n\t\t\t\tlist.push([obj, p]);\n\t\t\t}\n\t\t}\n\t\tcancelList = list.map(\n\t\t\t([obj, p]) => watchProp(\n\t\t\t\tobj,\n\t\t\t\tp,\n\t\t\t\ttrigger,\n\t\t\t\toptions?.disdeferable,\n\t\t\t),\n\t\t);\n\t}\n\tfunction stop() {\n\t\tif (!cancel()) { return; }\n\t\tcb(false);\n\t};\n\tconst thisRead: ReadMap = new Map();\n\tconst result = observe(thisRead, () => fn(stop), { postpone });\n\trun(thisRead);\n\tif (options?.resultOnly) { return result; }\n\treturn { result, stop };\n}\n\n/**\n * 创建可监听执行函数\n * @param fn 要监听执行的函数\n * @param cb 当监听的值发生可能改变时触发的回调函数，单如果没有被执行的函数或抛出错误，将会在每次 fn 被执行后直接执行\n */\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\tfn: (stop: () => void) => T,\n\toptions?: ExecOptions & {resultOnly?: false},\n): ExecResult<T>;\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\toptions: ExecOptions & {resultOnly?: false} | undefined,\n\tfn?: (stop: () => void) => T,\n): ExecResult<T>;\n\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\tfn: (stop: () => void) => T,\n\toptions: ExecOptions & {resultOnly: true},\n): T;\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\toptions: ExecOptions & {resultOnly: true},\n\tfn: (stop: () => void) => T,\n): T;\n\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\tfn: (stop: () => void) => T,\n\toptions?: ExecOptions,\n): ExecResult<T> | T;\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\toptions: ExecOptions | undefined,\n\tfn: (stop: () => void) => T,\n): ExecResult<T> | T;\n\nexport function exec<T>(\n\tcb: (changed: boolean) => void,\n\tfn: ((stop: () => void) => T) | ExecOptions | undefined,\n\toptions?: ((stop: () => void) => T) | ExecOptions | undefined,\n): ExecResult<T> | T  {\n\tif (typeof cb !== 'function') {\n\t\tthrow new Error('cb needs to be a function');\n\t}\n\tif (typeof fn === 'function') {\n\t\treturn run(cb, fn, options as ExecOptions | undefined);\n\t}\n\tif (typeof options !== 'function') {\n\t\tthrow new Error('fn needs to be a function');\n\t}\n\treturn run(cb, options, fn);\n}\n","import { safeify } from './utils';\nimport { observe, watchProp, ReadMap, ObserveOptions } from './mark';\n\nexport interface Monitored<T, P extends any[] = []> {\n\t(...p: P): T;\n\tstop(): void;\n}\nexport interface MonitorOptions extends ObserveOptions {\n\tdisdeferable?: boolean;\n}\n/**\n * 创建可监听执行函数\n * @param fn 要监听执行的函数\n * @param cb 当监听的值发生可能改变时触发的回调函数，单如果没有被执行的函数或抛出错误，将会在每次 fn 被执行后直接执行\n */\nfunction create<T, P extends any[] = []>(\n\tcb: (changed: boolean) => void,\n\tfn: (...p: P) => T,\n\toptions?: MonitorOptions,\n): Monitored<T, P> {\n\tcb = safeify(cb);\n\tlet cancelList: (() => void)[] | undefined;\n\t/** 取消监听 */\n\tfunction cancel() {\n\t\tif (!cancelList) { return false; }\n\t\tconst list = cancelList;\n\t\tcancelList = undefined;\n\t\tlist.forEach(f => f());\n\t\treturn true;\n\t}\n\tfunction trigger() {\n\t\tif (!cancel()) { return; }\n\t\tcb(true);\n\t};\n\tfunction run(thisRead: ReadMap) {\n\t\tif (!thisRead.size) {\n\t\t\treturn cb(false);\n\t\t}\n\t\tconst list: [\n\t\t\tobject | Function,\n\t\t\tstring | boolean | symbol,\n\t\t][] = [];\n\t\tfor ( let [obj, props] of thisRead) {\n\t\t\tfor (const [p, m] of props) {\n\t\t\t\tif (m) { return cb(true); }\n\t\t\t\tlist.push([obj, p]);\n\t\t\t}\n\t\t}\n\t\tcancelList = list.map(\n\t\t\t([obj, p]) => watchProp(\n\t\t\t\tobj,\n\t\t\t\tp,\n\t\t\t\ttrigger,\n\t\t\t\toptions?.disdeferable,\n\t\t\t),\n\t\t);\n\t}\n\tfunction exec(...p: P) {\n\t\tcancel();\n\t\tconst thisRead: ReadMap = new Map();\n\t\tconst result = observe(thisRead, () => fn(...p), options);\n\t\trun(thisRead);\n\t\treturn result;\n\t}\n\texec.stop = () => {\n\t\tif (!cancel()) { return; }\n\t\tcb(false);\n\t};\n\treturn exec;\n}\n\n/**\n * 创建可监听执行函数\n * @param fn 要监听执行的函数\n * @param cb 当监听的值发生可能改变时触发的回调函数，单如果没有被执行的函数或抛出错误，将会在每次 fn 被执行后直接执行\n */\nexport function monitor<T, P extends any[] = []>(\n\tcb: (changed: boolean) => void,\n\tfn: (...p: P) => T,\n\toptions?: MonitorOptions,\n): Monitored<T, P>\nexport function monitor<T, P extends any[] = []>(\n\tcb: (changed: boolean) => void,\n\toptions: MonitorOptions | undefined,\n\tfn: (...p: P) => T,\n): Monitored<T, P>;\nexport function monitor<T, P extends any[] = []>(\n\tcb: (changed: boolean) => void,\n\tfn: ((...p: P) => T) | MonitorOptions | undefined,\n\toptions?: ((...p: P) => T) | MonitorOptions,\n): Monitored<T, P>;\nexport function monitor<T, P extends any[] = []>(\n\tcb: (changed: boolean) => void,\n\tfn: ((...p: P) => T) | MonitorOptions | undefined,\n\toptions?: ((...p: P) => T) | MonitorOptions,\n): Monitored<T, P> {\n\tif (typeof fn === 'function') {\n\t\treturn create(cb, fn, options as MonitorOptions | undefined);\n\t}\n\tif (typeof options !== 'function') {\n\t\tthrow new Error('fn needs to be a function');\n\t}\n\treturn create(cb, options, fn);\n}\n","import { safeCall } from './utils';\nimport { markRead, markChange, watchProp } from './mark';\nimport { monitor } from './monitor';\n\n/** 取消监听的方法 */\nexport interface CancelWatch {\n\t(): void;\n}\n/** 监听函数 */\nexport interface WatchCallback<T, V extends Value<T> = Value<T>> {\n\t(v: V, stopped: boolean): void;\n}\n/** 可监听值 */\nexport interface Value<T> {\n\t(): T;\n\t(v: T, mark?: boolean): T;\n\tvalue: T;\n\twatch(cb: WatchCallback<T, this>, disdeferable?: boolean): CancelWatch;\n\tstop(): void;\n\ttoString(...p: T extends {toString(...p: infer P): string} ? P : any): string;\n\tvalueOf(): T extends {valueOf(): infer R} ? R : T;\n}\nconst valueSignKey = '__$$__monitorable_value__$$__';\nexport function isValue(x: any): x is Value<any> {\n\treturn Boolean(typeof x === 'function' && x[valueSignKey]);\n}\n/** 触发监听 */\ninterface Trigger {\n\t(): void;\n\t/** 是否存在监听函数 */\n\thas(): boolean;\n\t/** 停止监听 */\n\tstop(): void;\n}\n\n\nfunction valueOf<T>(this: Value<T>) {\n\tconst value = this();\n\tif (value === undefined) { return value; }\n\tif (value === null) { return value; }\n\treturn (value as any).valueOf();\n}\nfunction toString<T>(this: Value<T>, ...p: any) {\n\tconst value = this();\n\tif (value === undefined) { return String(value); }\n\tif (value === null) { return String(value); }\n\tif (typeof (value as any).toString === 'function') {\n\t\treturn (value as any).toString(...p);\n\t}\n\treturn String(value);\n}\nfunction toPrimitive<T>(this: Value<T>, hint?: 'string' | 'number' | 'default') {\n\tconst value = this();\n\tif (value === undefined) { return String(value); }\n\tif (value === null) { return String(value); }\n\tif (typeof (value as any)[Symbol.toPrimitive] === 'function') {\n\t\treturn (value as any)[Symbol.toPrimitive](hint);\n\t}\n\tif (hint === 'string') {\n\t\treturn String(value);\n\t}\n\tif (hint === 'number') {\n\t\treturn Number(value);\n\t}\n\treturn value;\n}\n\nfunction createValue<T, V extends Value<T> = Value<T>>(\n\trecover: () => T,\n\tsetValue?: (value: T, markChange: () => void) => void,\n\tstop: () => void = () => {},\n\tchange: () => void = () => {},\n): {value: V, trigger: Trigger} {\n\tfunction set(v: T, marked = false) {\n\t\tif (!setValue) { return; }\n\t\ttry {\n\t\t\tsetValue(v, () => { marked = true; });\n\t\t} finally {\n\t\t\tif (marked) {\n\t\t\t\ttrigger();\n\t\t\t}\n\t\t}\n\t}\n\tfunction get() {\n\t\tmarkRead(value, 'value');\n\t\treturn recover();\n\t}\n\tconst value: V = ((...v: [T] | [T, boolean] | []): T => {\n\t\tif (v.length) {\n\t\t\tset(v[0], v[1]);\n\t\t\treturn v[0];\n\t\t}\n\t\treturn get();\n\t}) as V;\n\tReflect.defineProperty(value, 'value', {\n\t\tget,\n\t\tset,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(value, 'valueOf', {\n\t\tvalue: valueOf,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(value, 'toString', {\n\t\tvalue: toString,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n\n\tReflect.defineProperty(value, Symbol.toPrimitive, {\n\t\tvalue: toPrimitive,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n\n\tlet stopList: Set<() => void> | undefined = new Set();\n\tfunction watch(\n\t\tcb: WatchCallback<T, V>,\n\t\tdisdeferable?: boolean,\n\t): () => void {\n\t\tif (!stopList) { return () => {}; }\n\t\tconst cancel = watchProp(\n\t\t\tvalue,\n\t\t\t'value',\n\t\t\t() => cb(value, false),\n\t\t\tdisdeferable,\n\t\t);\n\t\tlet cancelled = false;\n\t\tconst stop = () => {\n\t\t\tif (cancelled) { return; }\n\t\t\tcancelled = true;\n\t\t\tif (stopList) { stopList.delete(stop); }\n\t\t\tcancel();\n\t\t\tsafeCall(() => cb(value, true));\n\t\t};\n\t\tstopList.add(stop);\n\t\tchange();\n\t\treturn () => {\n\t\t\tif (cancelled) { return; }\n\t\t\tcancelled = true;\n\t\t\tif (stopList) { stopList.delete(stop); }\n\t\t\tcancel();\n\t\t\tchange();\n\t\t};\n\t}\n\tReflect.defineProperty(value, 'watch', {\n\t\tget() { return watch; },\n\t\tset() {},\n\t\tconfigurable: true,\n\t});\n\tconst trigger = (() => markChange(value, 'value')) as Trigger;\n\ttrigger.has = () => Boolean(stopList?.size);\n\ttrigger.stop = () => {\n\t\tif (!stopList) { return; }\n\t\tconst list = stopList;\n\t\tstopList = undefined;\n\t\tfor (const stop of [...list]) {\n\t\t\tstop();\n\t\t}\n\t};\n\tReflect.defineProperty(value, valueSignKey, { value: true, configurable: true });\n\tlet stopped = false;\n\tvalue.stop = () => {\n\t\tif (stopped) { return; }\n\t\tstopped = true;\n\t\tstop();\n\t\ttrigger.stop();\n\n\t};\n\treturn {value, trigger};\n}\n/**\n * 创建引用值\n * @param value 初始值\n * @param options 选项\n */\nexport function value<T>(def: T): Value<T> {\n\tlet source: T;\n\tlet proxyValue: T;\n\tconst { value } = createValue<T>(\n\t\t() => proxyValue,\n\t\t(v, mark) => {\n\t\t\tif (v === source) { return; }\n\t\t\tsource = v;\n\t\t\tproxyValue = source;\n\t\t\tmark();\n\t\t},\n\t);\n\tvalue(def);\n\treturn value;\n}\n\nexport interface ComputedOptions {\n\tpostpone?: boolean | 'priority';\n\tdeferable?: boolean;\n}\n/**\n * 创建计算值\n * @param getter 取值方法\n * @param options 选项\n */\nexport function computed<T>(\n\tgetter: () => T,\n\toptions?: ComputedOptions,\n): Value<T>;\n/**\n * 创建可赋值计算值\n * @param getter 取值方法\n * @param setter 复制方法\n * @param options 选项\n */\nexport function computed<T>(\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n\toptions?: ComputedOptions,\n): Value<T>;\nexport function computed<T>(\n\tgetter: () => T,\n\tsetter?: ((value: T) => void) | ComputedOptions,\n\toptions?: ComputedOptions,\n): Value<T>;\nexport function computed<T>(\n\tgetter: () => T,\n\tsetter?: ((value: T) => void) | ComputedOptions,\n\toptions?: ComputedOptions,\n): Value<T> {\n\tif (typeof setter !== 'function') {\n\t\toptions = setter;\n\t\tsetter = undefined;\n\t}\n\tconst setValue = setter;\n\tconst postpone = options?.postpone;\n\tconst deferable = options?.deferable;\n\tlet source: T;\n\tlet proxyValue: T;\n\tlet stopped = false;\n\tlet computed = false;\n\tlet trigger: Trigger | undefined;\n\tconst executable = monitor(changed => {\n\t\tcomputed = !changed;\n\t\tif (changed  && trigger) {\n\t\t\ttrigger();\n\t\t}\n\t}, getter, { postpone, disdeferable: !deferable });\n\tfunction run() {\n\t\tcomputed = true;\n\t\ttry {\n\t\t\tsource = executable();\n\t\t\tproxyValue = source;\n\t\t\treturn proxyValue;\n\t\t} catch(e) {\n\t\t\tif (!stopped) {\n\t\t\t\tcomputed = false;\n\t\t\t}\n\t\t\tthrow e;\n\t\t}\n\t}\n\tlet value: Value<T>;\n\t({value, trigger} = createValue<T, Value<T>>(\n\t\t() => computed || stopped ? proxyValue : run(),\n\t\tsetValue && (v => setValue(v)),\n\t\t() => {\n\t\t\tif (stopped) { return; }\n\t\t\tstopped = true;\n\t\t\tif (computed) { return; }\n\t\t\trun();\n\t\t},\n\t));\n\treturn value;\n\n}\n","import {\n\tValue,\n\tcomputed,\n\tisValue,\n} from './value';\n\nexport type DeValue<T> = T extends Value<infer V> ? V : T;\nexport type EnValue<T> = Value<DeValue<T>>;\n\nexport interface Valueify<T> {\n\t<K extends keyof T>(\n\t\tkey: K,\n\t\tdef?: Value<DeValue<T[K]> | undefined>,\n\t\tset?: (value: DeValue<T[K]>, setted: boolean) => void\n\t): Value<DeValue<T[K]> | undefined>\n}\n\nfunction createValue<T, K extends keyof T>(\n\tprops: T,\n\tkey: K,\n\tdef?: Value<DeValue<T[K]> | undefined>,\n\tset?: (value: DeValue<T[K]>, setted: boolean) => void,\n): Value<DeValue<T[K]> | undefined> {\n\tfunction setValue(value: DeValue<T[K]>, setted: boolean): void {\n\t\tif (!set) { return; }\n\t\tset(value, setted);\n\t}\n\treturn computed(() => {\n\t\tconst p = props[key];\n\t\tif (p === undefined && def) { return def(); }\n\t\treturn isValue(p) ? p() : p;\n\t}, v => {\n\t\tconst p = props[key];\n\t\tif (isValue(p)) {\n\t\t\tp(v);\n\t\t\tsetValue(v, true);\n\t\t\treturn;\n\t\t}\n\t\tif (p === undefined && def) { def(v); }\n\t\tsetValue(v, false);\n\t});\n}\nexport function valueify<T extends object>(props: T): Valueify<T>;\nexport function valueify<T extends object, K extends keyof T>(\n\tprops: T,\n\tkey: K,\n\tdef?: Value<DeValue<T[K]> | undefined>,\n\tset?: (value: DeValue<T[K]>, setted: boolean) => void,\n): Value<DeValue<T[K]> | undefined>;\nexport function valueify<T extends object, K extends keyof T>(\n\tprops: T,\n\tkey: K[],\n\tdef?: (key: K) => Value<DeValue<T[K]> | undefined>,\n\tset?: (value: DeValue<T[K]>, setted: boolean, key: K) => void,\n): {[k in K]: Value<DeValue<T[k]> | undefined>};\nexport function valueify<T extends object, K extends keyof T>(\n\tprops: T,\n\tkey?: K | K[],\n\tdef?: (key: K) => Value<DeValue<T[K]> | undefined>,\n\tset?: (value: DeValue<T[K]>, setted: boolean, key?: K) => void\n): Valueify<T>\n| Value<DeValue<T[K]> | undefined>\n| {[k in K]: Value<DeValue<T[k]> | undefined>} {\n\tif (!key) {\n\t\treturn (k, d, s) => createValue(props, k, d, s);\n\t}\n\tif (!Array.isArray(key)) {\n\t\treturn createValue(\n\t\t\tprops,\n\t\t\tkey,\n\t\t\tdef as Value<DeValue<T[K]> | undefined>,\n\t\t\tset,\n\t\t);\n\t}\n\tconst r = Object.create(null);\n\tfor (const k of key) {\n\t\tconst value = createValue(\n\t\t\tprops,\n\t\t\tk,\n\t\t\tdef && def(k),\n\t\t\tset && ((v, s) => set!(v, s, k))\n\t\t);\n\t\tReflect.defineProperty(props, k, {\n\t\t\tget() { return value(); },\n\t\t\tset(v) { value.value = v; },\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t}\n\treturn r;\n}\nexport function mixValue<T extends object, K extends keyof T>(\n\tsource: T,\n\tprops = Reflect.ownKeys(source) as K[] | {\n\t\t[k in K]?: Value<DeValue<T[k]> | undefined>;\n\t},\n\tset?: (value: DeValue<T[K]>, key?: K) => void\n): { [k in keyof T]: k extends K ? DeValue<T[k]> : T[k]; } {\n\tconst p = Object.create(source);\n\tfunction setValue(value: DeValue<T[K]>, key: K): void {\n\t\tif (!set) { return; }\n\t\tset(value, key);\n\t}\n\tconst keys = (Array.isArray(props) ? props : Reflect.ownKeys(props)) as K[];\n\tconst values = Array.isArray(props) ? source : props;\n\tfor (const key of keys) {\n\t\tconst value = values[key];\n\t\tif (!isValue(value)) { continue; }\n\t\tReflect.defineProperty(p, key, {\n\t\t\tget() { return value(); },\n\t\t\tset(v) { value.value = v; setValue(v, key); },\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t}\n\treturn p;\n}\n\nexport interface AsValue<T> {\n\t<K extends keyof T>(key: K): EnValue<T[K]>\n}\n\nfunction createAsValue<T, K extends keyof T>(\n\tprops: T,\n\tkey: K,\n): EnValue<T[K]> {\n\treturn computed(() => {\n\t\tconst p = props[key];\n\t\treturn isValue(p) ? p() : p;\n\t}, v => {\n\t\tconst p = props[key];\n\t\tif (isValue(p)) {\n\t\t\tp(v);\n\t\t} else {\n\t\t\tprops[key] = v;\n\t\t}\n\t});\n}\nexport function asValue<T>(props: T): AsValue<T>;\nexport function asValue<T, K extends keyof T>(\n\tprops: T,\n\tkey: K,\n): EnValue<T[K]>;\nexport function asValue<T, K extends keyof T>(\n\tprops: T,\n\tkey?: K,\n): AsValue<T> | EnValue<T[K]> {\n\tif (arguments.length >= 2) {\n\t\treturn createAsValue(props, key!);\n\t}\n\treturn k => createAsValue(props, k);\n}\n","\nimport {\n\tValue,\n\tWatchCallback,\n} from './value';\n\nexport function merge<T, V extends Value<T> = Value<T>>(\n\tcb: WatchCallback<T, V>\n): WatchCallback<T, V> {\n\tlet oldValue: any;\n\tlet ran = false;\n\treturn (v, stopped) => {\n\t\tif (stopped) { return cb(v, stopped); }\n\t\tconst newValue = v();\n\t\tif (newValue === oldValue && ran) { return; }\n\t\tran = true;\n\t\toldValue = newValue;\n\t\tcb(v, stopped);\n\t};\n}\n","import { markChange, markRead } from './mark';\nexport function defineProperty<\n\tT extends object,\n\tK extends keyof T,\n\tV extends T[K]\n>(obj: T, key: K, val: V): boolean {\n\treturn Reflect.defineProperty(obj, key, {\n\t\tget() {\n\t\t\tmarkRead(obj, key);\n\t\t\treturn val;\n\t\t},\n\t\tset(v) {\n\t\t\tif (v === val) { return; }\n\t\t\tval = v;\n\t\t\tmarkChange(obj, key);\n\t\t},\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t});\n}\nexport function createObject<T extends object>(\n\tkeys: (keyof T)[],\n\tbase: T | null = {} as T,\n\tcreate?: boolean\n): T {\n\tconst obj = create || base === null ? Object.create(base) : base;\n\tfor (const key of keys) {\n\t\tlet val = obj[key];\n\t\tReflect.defineProperty(obj, key, {\n\t\t\tget() {\n\t\t\t\tmarkRead(obj, key);\n\t\t\t\treturn val;\n\t\t\t},\n\t\t\tset(v) {\n\t\t\t\tif (v === val) { return; }\n\t\t\t\tval = v;\n\t\t\t\tmarkChange(obj, key);\n\t\t\t},\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t}\n\treturn obj;\n}\n\nexport function get<\n\tT extends object,\n\tK extends keyof T,\n>(obj: T, key: K): T[K] {\n\tmarkRead(obj, key);\n\treturn obj[key];\n}\n\nexport function set<\n\tT extends object,\n\tK extends keyof T,\n\tV extends T[K]\n>(obj: T, key: K, v: V): V {\n\tif (v === obj[key]) { return v; }\n\tobj[key] = v;\n\tmarkChange(obj, key);\n\treturn v;\n}\n","import { markChange, markRead } from './mark';\n\n/**\n * 判断对象是否可被代理\n */\nfunction encashable(v: any): v is object | Function {\n\treturn Boolean(v && ['object', 'function'].includes(typeof v));\n}\n\nlet getValue: any;\n/**\n * 获取被代理对象\n * @param obj  要被代理的对象\n * @param nest 递归代理的层数\n */\nexport function encase<T>(value: T, nest: number | boolean = 0): T {\n\tif (!encashable(value)) { return value; }\n\tconst original = recover(value);\n\tconst nestLayer: number = nest === true ? Infinity : nest || 0;\n\tconst proxy = new Proxy(original, {\n\t\tset(target, prop, value, receiver) {\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.set(target, prop, value, receiver);\n\t\t\t}\n\t\t\tconst has = Reflect.has(target, prop);\n\t\t\tconst old = Reflect.get(target, prop, receiver);\n\t\t\tconst modified =\n\t\t\t\tReflect.set(target, prop, value, encase(receiver));\n\t\t\tif (!modified) { return modified; }\n\t\t\tif (has !== Reflect.has(target, prop)) {\n\t\t\t\tmarkChange(receiver, true);\n\t\t\t}\n\t\t\tif (old !== Reflect.get(target, prop, receiver)) {\n\t\t\t\tmarkChange(receiver, prop);\n\t\t\t}\n\t\t\treturn modified;\n\t\t},\n\t\tget(target, prop, receiver) {\n\t\t\tif (getValue === proxy) {\n\t\t\t\tif (prop === '__monitorable__recover__') {\n\t\t\t\t\tgetValue = original;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.get(target, prop, receiver);\n\t\t\t}\n\t\t\tmarkRead(receiver, prop);\n\t\t\tconst value = Reflect.get(target, prop, encase(receiver));\n\t\t\tif (nestLayer > 0) { return encase(value, nestLayer - 1); }\n\t\t\treturn value;\n\t\t},\n\t\tsetPrototypeOf(target, proto) {\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.setPrototypeOf(target, proto);\n\t\t\t}\n\t\t\tconst oldProto = Reflect.getPrototypeOf(target);\n\t\t\tconst modified = Reflect.setPrototypeOf(target, proto);\n\t\t\tif (modified && oldProto !== proto) {\n\t\t\t\tmarkChange(target, false);\n\t\t\t\tmarkChange(proxy, false);\n\t\t\t}\n\t\t\treturn modified;\n\t\t},\n\t\tgetPrototypeOf(target) {\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.getPrototypeOf(target);\n\t\t\t}\n\t\t\tmarkRead(target, false);\n\t\t\tmarkRead(proxy, false);\n\t\t\tconst value: any = Reflect.getPrototypeOf(target);\n\t\t\tif (nestLayer > 0) {\n\t\t\t\treturn encase(value, nestLayer - 1);\n\t\t\t}\n\t\t\treturn value;\n\t\t},\n\t\tdefineProperty(target, prop, attr) {\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.defineProperty(target, prop, attr);\n\t\t\t}\n\t\t\tlet changed = true;\n\t\t\tif ('value' in attr) {\n\t\t\t\tconst desc =\n\t\t\t\t\tReflect.getOwnPropertyDescriptor(target, prop);\n\t\t\t\tif (\n\t\t\t\t\tdesc && 'value' in desc\n\t\t\t\t\t&& recover(attr.value) === recover(desc.value)) {\n\t\t\t\t\tchanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst modified = Reflect.defineProperty(target, prop, attr);\n\t\t\tif (changed && modified) {\n\t\t\t\tmarkChange(target, prop);\n\t\t\t\tmarkChange(proxy, prop);\n\t\t\t}\n\t\t\treturn modified;\n\t\t},\n\t\tgetOwnPropertyDescriptor(target, prop) {\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.getOwnPropertyDescriptor(target, prop);\n\t\t\t}\n\t\t\tmarkRead(target, prop);\n\t\t\tmarkRead(proxy, prop);\n\t\t\treturn Reflect.getOwnPropertyDescriptor(target, prop);\n\t\t},\n\t\tdeleteProperty(target, prop) {\n\t\t\tif (nest === false) {\n\t\t\t\treturn Reflect.deleteProperty(target, prop);\n\t\t\t}\n\t\t\tconst has = Reflect.has(target, prop);\n\t\t\tconst deleted = Reflect.deleteProperty(target, prop);\n\t\t\tif (has && !Reflect.has(target, prop)) {\n\t\t\t\tmarkChange(target, prop);\n\t\t\t\tmarkChange(target, true);\n\t\t\t\tmarkChange(proxy, prop);\n\t\t\t\tmarkChange(proxy, true);\n\t\t\t}\n\t\t\treturn deleted;\n\t\t},\n\t\townKeys(target) {\n\t\t\tif (nest === false) { return Reflect.ownKeys(target); }\n\t\t\tmarkRead(target, true);\n\t\t\tmarkRead(proxy, true);\n\t\t\treturn Reflect.ownKeys(target);\n\t\t},\n\t\thas(target, prop) {\n\t\t\tif (nest === false) { return Reflect.has(target, prop); }\n\t\t\tmarkRead(target, true);\n\t\t\tmarkRead(proxy, true);\n\t\t\treturn Reflect.has(target, prop);\n\t\t},\n\t});\n\treturn proxy;\n}\n/** 获取被代理的原始值 */\nexport function recover<T>(v: T): T {\n\tif (!v) { return v; }\n\tif (!encashable(v)) { return v; }\n\tlet value = v;\n\ttry {\n\t\tgetValue = v;\n\t\tvalue = (v as any).__monitorable__recover__;\n\t} catch {}\n\tvalue = getValue;\n\tgetValue = false;\n\tif (!value) { return v; }\n\tif (typeof value === 'object') { return value; }\n\tif (typeof value === 'function') { return value; }\n\treturn v;\n}\nexport function equal(a: any, b: any): boolean {\n\treturn recover(a) === recover(b);\n}\n"],"names":["printErrorLog","printError","info","console","error","setPrintError","p","undefined","encashable","v","Boolean","includes","safeify","fn","e","safeCall","getIndexes","target","prop","String","getMapValue","map","key","def","has","get","value","set","read","markRead","indexes","propMap","Map","observeRun","options","oldRead","postpone","observe","Error","watchList","WeakMap","execWatch","filter","watch","list","t","forEach","w","waitList","runDeferred","entries","postponeRun","f","priority","old","wait","Set","add","markChange","watchProp","cb","disdeferable","item","removed","delete","size","run","cancelList","end","cancel","trigger","thisRead","obj","props","m","push","stop","result","resultOnly","exec","create","monitor","valueSignKey","isValue","x","valueOf","toString","toPrimitive","hint","Symbol","Number","createValue","recover","setValue","change","marked","length","Reflect","defineProperty","enumerable","configurable","stopList","cancelled","stopped","source","proxyValue","mark","computed","getter","setter","deferable","executable","changed","setted","valueify","k","d","s","Array","isArray","r","Object","mixValue","ownKeys","keys","values","createAsValue","asValue","arguments","merge","oldValue","ran","newValue","val","createObject","base","getValue","encase","nest","original","nestLayer","Infinity","proxy","Proxy","receiver","modified","setPrototypeOf","proto","oldProto","getPrototypeOf","attr","desc","getOwnPropertyDescriptor","deleteProperty","deleted","__monitorable__recover__","equal","a","b"],"mappings":"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"}