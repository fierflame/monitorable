/*!
 * monitorable v0.0.0
 * (c) 2020 Fierflame
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Monitorable={})}(this,(function(e){"use strict";function t(e){return(...t)=>{try{e(...t)}catch(e){console.error(e)}}}const n=new WeakMap,o={get:(e,t,n)=>(u(e,"number"==typeof t?String(t):t),Reflect.get(e,t,n)),set:(e,t,n,o)=>(Reflect.get(e,t,o)!==n&&s(e,"number"==typeof t?String(t):t),Reflect.set(e,t,n,o))};function r(e){return function(e){return Boolean(e&&["object","function"].includes(typeof e))}(e)?n.has(e)?e:new Proxy(e,o):e}function f(e){return n.get(e)||e}let i;function u(e,t){if(!i)return;let n=i.get(e);n||(n=new Set,i.set(e,n)),n.add(t)}const c=new WeakMap;function l(e,t,n){if(!e)return()=>{};if("object"!=typeof e&&"function"!=typeof e)return()=>{};if("function"!=typeof n)return()=>{};if("symbol"!=typeof t&&"string"!=typeof t)return()=>{};e=f(e);let o=c.get(e);o||(o=new Map,c.set(e,o));let r=o.get(t);r||(r=[],o.set(t,r)),r.push(n);let i=!1;return()=>{if(i)return;if(i=!0,!r)return;const f=r.findIndex(e=>e===n);f<0||(r.splice(f,1),r.length||o&&(o.delete(t),o.size||c.delete(e)))}}function s(e,t){var n,o;if(!e)return;if("object"!=typeof e&&"function"!=typeof e)return;if("number"==typeof t)t=String(t);else if("symbol"!=typeof t&&"string"!=typeof t)return;const r=null===(n=c.get(e))||void 0===n?void 0:null===(o=n.get)||void 0===o?void 0:o.call(n,t);if(r)for(const e of[...r])try{e()}catch(e){console.error(e)}}const a=new WeakSet;function p(e){return a.has(e)}function d(e,n,o=(()=>{}),r=(()=>{})){function f(t,n=!1){try{return e(t,()=>{n=!0})}finally{n&&d()}}function i(){return u(c,"value"),n()}const c=(...e)=>e.length?(f(e[0],e[1]),e[0]):i();function l(e){if(!p)return()=>{};e=t(e),p.push(e),r();let n=!1;return()=>{if(n)return;if(n=!0,!p)return;const t=p.findIndex(t=>t===e);t<0||(p.splice(t,1),r())}}Reflect.defineProperty(c,"value",{get:i,set:f,enumerable:!0,configurable:!0});let p=[];Reflect.defineProperty(c,"watch",{get:()=>l,set(){},configurable:!0});const d=()=>{if(p){s(c,"value");for(const e of[...p])e(c,!1)}};d.has=()=>{var e;return Boolean(null===(e=p)||void 0===e?void 0:e.length)},d.stop=()=>{if(!p)return;const e=p;p=void 0;for(const t of[...e])t(c,!0)},a.add(c);let y=!1;return c.stop=()=>{y||(y=!0,o(),d.stop())},{value:c,trigger:d}}e.computed=function(e,n){const o=!0===n||n&&n.proxy;let u,c,s,a=!1,p=!1;const y=function(e,n){let o;function r(){if(!o)return!1;const e=o;return o=void 0,e.forEach(e=>e()),!0}function f(){r()&&n(!0)}function u(){r();const t=new Map,u=i;i=t;try{return e()}catch(e){throw t.clear(),e}finally{if(i=u,t.size){o=[];for(let[e,n]of t)for(const t of n)o.push(l(e,t,f))}else n(!1)}}return n=t(n),u.stop=()=>{r()&&n(!1)},u}(e,e=>{p=!e,e&&s&&s()});function g(){p=!0;try{return u=y(),o&&(u=f(u)),c=o?r(u):u,c}catch(e){throw a||(p=!1),e}}let v;return({value:v,trigger:s}=d((e,t)=>{},()=>p||a?c:g(),()=>{a||(a=!0,p||g())})),v},e.isValue=p,e.merge=function(e){let t,n=!1;return(o,r)=>{if(r)return e(o,r);const i=f(o());i===t&&n||(n=!0,t=i,e(o,r))}},e.mix=function(e){for(const t of Reflect.ownKeys(e)){const n=Reflect.getOwnPropertyDescriptor(e,t);if(!n)continue;if("get"in n||"set"in n||!("value"in n))continue;const o=n.value;p(o)&&(n.get=()=>o(),n.writable&&(n.set=e=>o(e)),delete n.value,delete n.writable,Reflect.defineProperty(e,t,n))}return e},e.value=function(e,t){const n=!0===t||t&&t.proxy;let o,i;const{value:u}=d((e,t)=>{n&&(e=f(e)),e!==o&&(o=e,i=n?r(o):o,t())},()=>i);return u(e),u},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=monitorable.min.js.map
