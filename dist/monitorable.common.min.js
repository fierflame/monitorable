/*!
 * monitorable v0.0.0
 * (c) 2020 Fierflame
 * @license MIT
 */
"use strict";function e(e){return(...t)=>{try{e(...t)}catch(e){console.error(e)}}}Object.defineProperty(exports,"__esModule",{value:!0});const t=new WeakMap,n={get:(e,t,n)=>(u(e,"number"==typeof t?String(t):t),Reflect.get(e,t,n)),set:(e,t,n,r)=>(Reflect.get(e,t,r)!==n&&l(e,"number"==typeof t?String(t):t),Reflect.set(e,t,n,r))};function r(e){return function(e){return Boolean(e&&["object","function"].includes(typeof e))}(e)?t.has(e)?e:new Proxy(e,n):e}function o(e){return t.get(e)||e}let f;function u(e,t){if(!f)return;let n=f.get(e);n||(n=new Set,f.set(e,n)),n.add(t)}const i=new WeakMap;function c(e,t,n){if(!e)return()=>{};if("object"!=typeof e&&"function"!=typeof e)return()=>{};if("function"!=typeof n)return()=>{};if("symbol"!=typeof t&&"string"!=typeof t)return()=>{};e=o(e);let r=i.get(e);r||(r=new Map,i.set(e,r));let f=r.get(t);f||(f=[],r.set(t,f)),f.push(n);let u=!1;return()=>{if(u)return;if(u=!0,!f)return;const o=f.findIndex(e=>e===n);o<0||(f.splice(o,1),f.length||r&&(r.delete(t),r.size||i.delete(e)))}}function l(e,t){var n,r;if(!e)return;if("object"!=typeof e&&"function"!=typeof e)return;if("number"==typeof t)t=String(t);else if("symbol"!=typeof t&&"string"!=typeof t)return;const o=null===(n=i.get(e))||void 0===n?void 0:null===(r=n.get)||void 0===r?void 0:r.call(n,t);if(o)for(const e of[...o])try{e()}catch(e){console.error(e)}}const s=new WeakSet;function a(e){return s.has(e)}function p(t,n,r=(()=>{}),o=(()=>{})){function f(e,n=!1){try{return t(e,()=>{n=!0})}finally{n&&y()}}function i(){return u(c,"value"),n()}const c=(...e)=>e.length?(f(e[0],e[1]),e[0]):i();function a(t){if(!p)return()=>{};t=e(t),p.push(t),o();let n=!1;return()=>{if(n)return;if(n=!0,!p)return;const e=p.findIndex(e=>e===t);e<0||(p.splice(e,1),o())}}Reflect.defineProperty(c,"value",{get:i,set:f,enumerable:!0,configurable:!0});let p=[];Reflect.defineProperty(c,"watch",{get:()=>a,set(){},configurable:!0});const y=()=>{if(p){l(c,"value");for(const e of[...p])e(c,!1)}};y.has=()=>{var e;return Boolean(null===(e=p)||void 0===e?void 0:e.length)},y.stop=()=>{if(!p)return;const e=p;p=void 0;for(const t of[...e])t(c,!0)},s.add(c);let g=!1;return c.stop=()=>{g||(g=!0,r(),y.stop())},{value:c,trigger:y}}exports.computed=function(t,n){const u=!0===n||n&&n.proxy;let i,l,s,a=!1,y=!1;const g=function(t,n){let r;function o(){if(!r)return!1;const e=r;return r=void 0,e.forEach(e=>e()),!0}function u(){o()&&n(!0)}function i(){o();const e=new Map,i=f;f=e;try{return t()}catch(t){throw e.clear(),t}finally{if(f=i,e.size){r=[];for(let[t,n]of e)for(const e of n)r.push(c(t,e,u))}else n(!1)}}return n=e(n),i.stop=()=>{o()&&n(!1)},i}(t,e=>{y=!e,e&&s&&s()});function d(){y=!0;try{return i=g(),u&&(i=o(i)),l=u?r(i):i,l}catch(e){throw a||(y=!1),e}}let v;return({value:v,trigger:s}=p((e,t)=>{},()=>y||a?l:d(),()=>{a||(a=!0,y||d())})),v},exports.isValue=a,exports.merge=function(e){let t,n=!1;return(r,f)=>{if(f)return e(r,f);const u=o(r());u===t&&n||(n=!0,t=u,e(r,f))}},exports.mix=function(e){for(const t of Reflect.ownKeys(e)){const n=Reflect.getOwnPropertyDescriptor(e,t);if(!n)continue;if("get"in n||"set"in n||!("value"in n))continue;const r=n.value;a(r)&&(n.get=()=>r(),n.writable&&(n.set=e=>r(e)),delete n.value,delete n.writable,Reflect.defineProperty(e,t,n))}return e},exports.value=function(e,t){const n=!0===t||t&&t.proxy;let f,u;const{value:i}=p((e,t)=>{n&&(e=o(e)),e!==f&&(f=e,u=n?r(f):f,t())},()=>u);return i(e),i};
//# sourceMappingURL=monitorable.common.min.js.map
