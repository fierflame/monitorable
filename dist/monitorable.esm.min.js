/*!
 * monitorable v0.1.0-alpha.0
 * (c) 2020 Fierflame
 * @license MIT
 */
let e;function t(t,n=!1){n||"function"!=typeof t&&void 0!==t?"function"!=typeof e?console.error(t):e(t):e=t}function n(e){return(...n)=>{try{e(...n)}catch(e){t(e,!0)}}}function r(e,t,n){if(e.has(t))return e.get(t);const r=n();return e.set(t,r),r}const o=new WeakMap;function f(e,t=0){if(n=e,!Boolean(n&&["object","function"].includes(typeof n)))return e;var n;if(o.has(e))return e;const r=!0===t?1/0:t||0;return new Proxy(e,{set(e,n,r,o){if(!1===t)return Reflect.set(e,n,r,o);const c=Reflect.has(e,n),i=Reflect.set(e,n,r,f(o));return i?(c!==Reflect.has(e,n)&&p(e,!0),i):i},get(e,n,o){if(!1===t)return Reflect.get(e,n,o);l(e,n);const c=Reflect.get(e,n,f(o));return r>0?f(c,r-1):c},setPrototypeOf(e,n){if(!1===t)return Reflect.setPrototypeOf(e,n);const r=Reflect.getPrototypeOf(e),o=Reflect.setPrototypeOf(e,n);return o&&r!==n&&p(e,!1),o},getPrototypeOf(e){if(!1===t)return Reflect.getPrototypeOf(e);l(e,!1);const n=Reflect.getPrototypeOf(e);return r>0?f(n,r-1):n},defineProperty(e,n,r){if(!1===t)return Reflect.defineProperty(e,n,r);let o=!0;if("value"in r){const t=Reflect.getOwnPropertyDescriptor(e,n);t&&"value"in t&&c(r.value)===c(t.value)&&(o=!1)}const f=Reflect.defineProperty(e,n,r);return o&&f&&p(e,n),f},getOwnPropertyDescriptor:(e,n)=>!1===t?Reflect.getOwnPropertyDescriptor(e,n):(l(e,n),Reflect.getOwnPropertyDescriptor(e,n)),deleteProperty(e,n){if(!1===t)return Reflect.deleteProperty(e,n);const r=Reflect.has(e,n),o=Reflect.deleteProperty(e,n);return r&&!Reflect.has(e,n)&&(p(e,n),p(e,!0)),o},ownKeys:e=>!1===t?Reflect.ownKeys(e):(l(e,!0),Reflect.ownKeys(e)),has:(e,n)=>!1===t?Reflect.has(e,n):(l(e,!0),Reflect.has(e,n))})}function c(e){return o.get(e)||e}function i(e,t){return c(e)===c(t)}let u;function l(e,t){if(!u)return;const n=r(u,e,()=>new Set);"number"==typeof t&&(t=String(t)),n.add(t)}function s(e,t=new Map,n=!1){const r=u;u=t;try{return e()}catch(e){throw n&&t.clear(),e}finally{u=r}}const a=new WeakMap;function p(e,t){var n,r;if(!e)return;if("object"!=typeof e&&"function"!=typeof e)return;if("number"==typeof t)t=String(t);else if("symbol"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t)return;const o=null===(n=a.get(e))||void 0===n?void 0:null===(r=n.get)||void 0===r?void 0:r.call(n,t);if(o)for(const e of[...o])e()}function y(e,t,o){if(!e)return()=>{};if("object"!=typeof e&&"function"!=typeof e)return()=>{};if("function"!=typeof o)return()=>{};if("number"==typeof t&&(t=String(t)),"symbol"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t)return()=>{};const f=t;e=c(e);let i=a.get(e);i||(i=new Map,a.set(e,i));const u=r(i,f,()=>new Set);o=n(o),u.add(o);let l=!1;return()=>{l||(l=!0,u.delete(o),u.size||i&&(i.delete(f),i.size||a.delete(e)))}}function g(e,t){let r;function o(){if(!r)return!1;const e=r;return r=void 0,e.forEach(e=>e()),!0}function f(){o()&&t(!0)}function c(){o();const n=new Map;try{return s(e,n,!0)}finally{if(n.size){r=[];for(let[e,t]of n)for(const n of t)r.push(y(e,n,f))}else t(!1)}}return t=n(t),c.stop=()=>{o()&&t(!1)},c}const d=new WeakSet;function R(e){return d.has(e)}function v(e,t,r=(()=>{}),o=(()=>{})){function f(e,n=!1){if(t)try{t(e,()=>{n=!0})}finally{n&&a()}}function c(){return l(i,"value"),e()}const i=(...e)=>e.length?(f(e[0],e[1]),e[0]):c();function u(e){if(!s)return()=>{};e=n(e),s.push(e),o();let t=!1;return()=>{if(t)return;if(t=!0,!s)return;const n=s.findIndex(t=>t===e);n<0||(s.splice(n,1),o())}}Reflect.defineProperty(i,"value",{get:c,set:f,enumerable:!0,configurable:!0});let s=[];Reflect.defineProperty(i,"watch",{get:()=>u,set(){},configurable:!0});const a=()=>{if(s){p(i,"value");for(const e of[...s])e(i,!1)}};a.has=()=>{var e;return Boolean(null===(e=s)||void 0===e?void 0:e.length)},a.stop=()=>{if(!s)return;const e=s;s=void 0;for(const t of[...e])t(i,!0)},d.add(i);let y=!1;return i.stop=()=>{y||(y=!0,r(),a.stop())},{value:i,trigger:a}}function w(e,t){const n=!0===t||t&&t.proxy;let r,o;const{value:i}=v(()=>o,(e,t)=>{n&&(e=c(e)),e!==r&&(r=e,o=n?f(r):r,t())});return i(e),i}function h(e,t,n){"function"!=typeof t&&(n=t,t=void 0);const r=t,o=!0===n||n&&n.proxy;let i,u,l,s=!1,a=!1;const p=g(e,e=>{a=!e,e&&l&&l()});function y(){a=!0;try{return i=p(),o&&(i=c(i)),u=o?f(i):i,u}catch(e){throw s||(a=!1),e}}let d;return({value:d,trigger:l}=v(()=>a||s?u:y(),r&&(e=>r(o?c(e):e)),()=>{s||(s=!0,a||y())})),d}function P(e){let t,n=!1;return(r,o)=>{if(o)return e(r,o);const f=c(r());f===t&&n||(n=!0,t=f,e(r,o))}}function b(e){for(const t of Reflect.ownKeys(e)){const n=Reflect.getOwnPropertyDescriptor(e,t);if(!n)continue;if("get"in n||"set"in n||!("value"in n))continue;const r=n.value;R(r)&&(n.get=()=>r.value,n.writable&&(n.set=e=>r.value=e),delete n.value,delete n.writable,Reflect.defineProperty(e,t,n))}return e}export{h as computed,g as createExecutable,i as equal,r as getMepValue,f as getProxy,c as getValue,R as isValue,p as markChange,l as markRead,P as merge,b as mix,s as observe,t as printError,n as safeify,w as value,y as watchProp};
//# sourceMappingURL=monitorable.esm.min.js.map
